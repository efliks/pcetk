------------
Introduction
------------

Proteins contain residues and cofactors that bind or release protons 
depending on the current pH and the interactions with their molecular
environment.

These titratable residues and cofactors will be refered to as sites.

Unfortunately, the titration of proteins is often difficult to study
experimentally since the available methods, such as calorimetry, 
cannot assign protonation states to individual sites.

The knowledge of these individual protonation states is crucial for
understanding of many processes of biological importance, for example
enzyme catalysis.

The ContinuumElectrostatic module extends the functionality of the 
pDynamo library with a Poisson-Boltzmann continuum electrostatic model 
that allows calculations of protonation states of individual sites.

The module provides a link between pDynamo and the external solver of 
the Poisson-Boltzmann equation, namely the MEAD program by Donald Bashford, 
extended by Timm Essigke.

The electrostatic energies obtained with MEAD can be used to directly calculate 
protonation state energies, but this is only possible for proteins with less than 
20 titratable sites.

For larger proteins, the state energies have to be sampled using a Monte Carlo
method.

The ContinuumElectrostatic module also provides a link to the GMCT program by
Matthias Ullmann and Thomas Ullmann that can be used to approximate probabilities
of protonation states.




The module is similar in behaviour to the multiflex2qmpb.pl program by Timm Essigke.

For the calculated thermodynamic cycle, see Fig. 3.8, p. 82 in Timm's thesis.

MEAD website: http://stjuderesearch.org/site/lab/bashford/

Extended MEAD website: http://www.bisb.uni-bayreuth.de/People/ullmannt/index.php?name=extended-mead



#  The most frequently used is the 
#  Poisson-Boltzmann method based on 
#  the Poisson equation relating the spatial variation 
#  of the protein electrostatic potential
#  to the charge density and dielectric constant. 




-------
Copying
-------

The module is distributed under the CeCILL Free Software Licence, which is
a French equivalent of the GNU open source licence (GNU GPL).

For details, see the files Licence_CeCILL_V2-en.txt (or Licence_CeCILL_V2-fr.txt).

-----
Usage
-----

For this module to be used, one should in the first step prepare CHARMM
topology (psf) and coordinate (crd) files for the protein of interest.

A pqr file is not needed because the atomic radii are assigned to atoms at runtime.

During the initial setup in CHARMM, all titratable residues in the protein should 
be set to their standard protonation states at pH = 7, i.e. aspartates and glutamates 
deprotonated, histidines doubly protonated, other residues protonated.


----------
Test cases
----------

----------
To-do list
----------

- Move parts of WriteJobFiles to the instance class

- Rename variables containing filenames so that they start from "file"

- Coordinates from the FPT file should have their own data structure?

- Efficiency improvements during partitioning of the system and writing job files?

- Use arrays instead of lists for interactions (Real1DArray or SymmetricMatrix?)

- Have a column of ETA (Estimated Time for Accomplishment) in MEAD calculations

- Optionally convert kcal/mol (MEAD units) to kJ/mol (pDynamo units)
