------------
Introduction
------------

Proteins contain residues and cofactors that bind or release protons 
depending on the current pH and the interactions with their molecular
environment.

These titratable residues and cofactors will be refered to as sites.

Unfortunately, the titration of proteins is often difficult to study
experimentally since the available methods, such as calorimetry, 
cannot assign protonation states to individual sites.

The knowledge of these individual protonation states is crucial for
understanding of many processes of biological importance, such as enzyme 
catalysis.

On the other hand, a number of theoretical methods have been 
developed for studying the titration of proteins on a computer.

The ContinuumElectrostatic module extends the functionality of the 
pDynamo library with a Poisson-Boltzmann continuum electrostatic model 
that allows for predictions of protonation states of individual sites.

The methods implemented in this module build upon earlier developments
by Don Bashford, extended by Timm Essigke, Matthias Ullmann 
and Thomas Ullmann.



#  Many protein residues, ligands and cofactors bind and release
#  protons depending on the current pH and interactions with
#  neighboring sites.

#  The available experimental methods for studying the titration 
#  of proteins, such as calorimetry, are unable to assign 
#  the protonation states to individual titratable sites.
#  %
#  Nuclear magnetic resonance spectroscopy can in principle detect
#  the positions of hydrogen atoms but it is limited to rather
#  small proteins.
#  %
#  However, the protonation probabilities of 
#  individual sites in the protein 
#  can be calculated based on the Poisson-Boltzmann 
#  electrostatic model (PBE) combined with a
#  Monte Carlo sampling\cite{Bombarda2006}.
#  %
#  The computational studies presented in this thesis highlight the
#  crucial role of electrostatic calculations in the elucidation
#  of enzymatic mechanisms\cite{Bombarda2010}.
#  
#  %-------------
#  There are several methods for the calculation of 
#  protein electrostatic potentials and
#  interaction energies\cite{Ullmann1999,Fogolari2002}.
#  %
#  The most frequently used is the 
#  Poisson-Boltzmann method based on 
#  the Poisson equation relating the spatial variation 
#  of the protein electrostatic potential
#  to the charge density and dielectric constant. 




ContinuumElectrostatics is a module that provides interface to 
the MEAD program by Donald Bashford, extended by Timm Essigke.

Developments are under way to interface the module with the GMCT program
by Matthias Ullmann.

The module is similar in behaviour to the multiflex2qmpb.pl program by Timm Essigke.

For the calculated thermodynamic cycle, see Fig. 3.8, p. 82 in Timm's thesis.

-------
Copying
-------

The module is distributed under the CeCILL Free Software Licence, which is
a French equivalent of the GNU open source licence (GNU GPL).

For details, see the files Licence_CeCILL_V2-en.txt (or Licence_CeCILL_V2-fr.txt).

-----
Usage
-----

For this module to be used, one should in the first step prepare CHARMM
topology (psf) and coordinate (crd) files for the protein of interest.

A pqr file is not needed because the atomic radii are assigned to atoms at runtime.

During the initial setup in CHARMM, all titratable residues in the protein should 
be set to their standard protonation states at pH = 7, i.e. aspartates and glutamates 
deprotonated, histidines doubly protonated, other residues protonated.


----------
Test cases
----------

----------
To-do list
----------

- Move parts of WriteJobFiles to the instance class

- Rename variables containing filenames so that they start from "file"

- Coordinates from the FPT file should have their own data structure?

- Efficiency improvements during partitioning of the system and writing job files?

- Use arrays instead of lists for interactions (Real1DArray or SymmetricMatrix?)

- Have a column of ETA (Estimated Time for Accomplishment) in MEAD calculations

- Optionally convert kcal/mol (MEAD units) to kJ/mol (pDynamo units)
